"use strict";(()=>{var e={};e.id=928,e.ids=[928],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4338:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>h,patchFetch:()=>k,requestAsyncStorage:()=>g,routeModule:()=>d,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m});var o={};s.r(o),s.d(o,{GET:()=>l,POST:()=>p});var r=s(5468),n=s(2197),a=s(4694),u=s(5685);let i=process.env.TELEGRAM_BOT_TOKEN,c=`https://api.telegram.org/bot${i}`;async function p(e){try{if(console.log("\uD83D\uDE80 Starting auto-setup for vonnect.net..."),!i)return u.NextResponse.json({success:!1,error:"TELEGRAM_BOT_TOKEN not configured"},{status:500});console.log("\uD83D\uDCE5 Getting recent updates...");let e=await fetch(`${c}/getUpdates?limit=100`),t=await e.json();if(!t.ok||0===t.result.length)return u.NextResponse.json({success:!1,error:"No recent messages found. Please send a message to @inmerzorrillabot first.",step:"get_updates"},{status:400});let s=t.result.filter(e=>e.message&&e.message.from&&!1===e.message.from.is_bot).sort((e,t)=>t.message.date-e.message.date);if(0===s.length)return u.NextResponse.json({success:!1,error:"No human messages found. Please send a message to @inmerzorrillabot first.",step:"find_human_messages"},{status:400});let o=s[0].message.from.id.toString(),r=s[0].message.from.first_name;console.log("✅ Found your chat ID:",o,"("+r+")"),console.log("\uD83C\uDF10 Setting webhook for vonnect.net...");let n="https://vonnect.net/api/telegram/webhook",a=await fetch(`${c}/setWebhook`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:n,allowed_updates:["message"],drop_pending_updates:!0})}),p=await a.json();if(!p.ok)return u.NextResponse.json({success:!1,error:"Failed to set webhook",details:p,step:"set_webhook"},{status:400});console.log("✅ Webhook configured successfully!"),console.log("\uD83D\uDCE4 Sending test message...");let l=`🎉 *Bot Configurado Exitosamente*

Tu Chat ID: \`${o}\`
Webhook: \`${n}\`

✅ El bot ya est\xe1 listo para funcionar en vonnect.net!

Ahora puedes recibir mensajes del chat widget directamente aqu\xed.`,d=await fetch(`${c}/sendMessage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:o,text:l,parse_mode:"Markdown"})}),g=await d.json();return u.NextResponse.json({success:!0,message:"Bot configured successfully!",data:{chatId:o,userName:r,webhookUrl:n,testMessageSent:g.ok}})}catch(e){return console.error("❌ Auto-setup error:",e),u.NextResponse.json({success:!1,error:"Internal server error",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function l(){try{let e=await fetch(`${c}/getWebhookInfo`),t=await e.json();return u.NextResponse.json({success:!0,webhook:{isConfigured:t.ok&&""!==t.result.url,currentUrl:t.result?.url||"Not set",isVonnectUrl:t.result?.url?.includes("vonnect.net")||!1},botToken:i?"Configured":"Not configured"})}catch(e){return u.NextResponse.json({success:!1,error:"Failed to check status"},{status:500})}}let d=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/app/api/telegram/auto-setup/route",pathname:"/app/api/telegram/auto-setup",filename:"route",bundlePath:"app/app/api/telegram/auto-setup/route"},resolvedPagePath:"C:\\Users\\pc\\Desktop\\BrainTask - Vonnect\\Vonnect_Web\\vonnect_redesign\\app\\app\\api\\telegram\\auto-setup\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:g,staticGenerationAsyncStorage:m,serverHooks:f}=d,h="/app/api/telegram/auto-setup/route";function k(){return(0,a.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:m})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),o=t.X(0,[343,769],()=>s(4338));module.exports=o})();